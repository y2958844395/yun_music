interface recommendDailyType {
  img: string // å›¾ç‰‡
  title: string // ç®€ä»‹æ–‡å­—
  type: string // æ ‡é¢˜æ–‡å­—
  top: string // æ ‡é¢˜èƒŒæ™¯è‰²
  bottom: string // ç®€ä»‹èƒŒæ™¯è‰²
}

interface recommendListType {
  img: string
  title: string
  count: string
}

@Component
export struct Recommend {

  // è½®æ’­å›¾æ•°æ®
  swiperList: string[] = [
    "http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/banner1.png",
    "http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/banner2.png",
    "http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/banner3.png",
    "http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/banner4.png",
    "http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/banner5.png"
  ]
  // æ¯æ—¥æŽ¨èæ•°æ®
  dailyRecommend: recommendDailyType[] = [
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/recommend1.png',
      title: 'æ¯æ—¥æŽ¨è | ä»Šå¤©ä»Žã€Šä¸å¾—ä¸çˆ±ã€‹å¬èµ· | ç§äººé›·è¾¾',
      type: 'æ¯æ—¥æŽ¨è',
      top: '#660000',
      bottom: '#382e2f'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/recommend2.png',
      title: 'ä»Ž [Nothing on Me] å¼€å¯æ— é™æ¼«æ¸¸',
      type: 'ç§äººæ¼«æ¸¸',
      top: '#382e2f',
      bottom: '#a37862'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/recommend3.png',
      title: 'æ¯æ—¥æŽ¨è | ä»Šå¤©ä»Žã€Šä¸å¾—ä¸çˆ±ã€‹å¬èµ· | ç§äººé›·è¾¾',
      type: 'åŽè¯­æµè¡Œ',
      top: '#a37862',
      bottom: '#174847'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/recommend4.png',
      title: 'æ¯æ—¥æŽ¨è | ä»Šå¤©ä»Žã€Šä¸å¾—ä¸çˆ±ã€‹å¬èµ· | ç§äººé›·è¾¾',
      type: 'ç§äººé›·è¾¾',
      top: '#174847',
      bottom: '#174847'
    }
  ]
  // æŽ¨èæ­Œå•æ•°æ®
  recommendList: recommendListType[] = [
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/list1.jpg',
      title: 'æ¯æ—¥æŽ¨è | ä»Šå¤©ä»Žã€Šä¸å¾—ä¸çˆ±ã€‹å¬èµ· | ç§äººé›·è¾¾',
      count: '270.9ä¸‡'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/list2.jpg',
      title: 'Yasuoå’Œæ›´å¤šå¥½å¬çš„ | åŽè¯­ç§äººé›·è¾¾ | å›žå¿†8090',
      count: '476.1ä¸‡'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/list3.jpg',
      title: 'Trap Remixä¸¨å½“æ¬§ç¾Žçƒ­å•é‡ä¸Šæ¯’æ€§ä½ŽéŸ³',
      count: '186.3ä¸‡'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/list4.jpg',
      title: 'æ»¡çº§äººç±»è¿›åŒ–ä¹‹è·¯å¿…å¤‡BGM | æ ¹æœ¬åœä¸ä¸‹æ¥',
      count: '186.3ä¸‡'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/list5.jpg',
      title: 'è®¤çœŸåŽ»è†å¬è¿™ä¸ªä¸–ç•Œçš„æ¯ä¸€åˆ†æ¯ä¸€ç§’ (å¼ºçƒˆæŽ¨è)',
      count: '362.8ä¸‡'
    },
    {
      img: 'http://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/HeimaCloudMusic/list5.jpg',
      title: 'è®¤çœŸåŽ»è†å¬è¿™ä¸ªä¸–ç•Œçš„æ¯ä¸€åˆ†æ¯ä¸€ç§’ (å¼ºçƒˆæŽ¨è)',
      count: '362.8ä¸‡'
    }
  ]
  @State refreshing: boolean = false

  @Builder
  titleBuilder(title: string) {
    Row() {
      Text(title)
        .fontColor('#fff')
        .fontWeight(700)
        .layoutWeight(1)
      Image($r('app.media.ic_more'))
        .width(22)
        .fillColor('#fff')
    }
    .width('100%')
    .height(40)
  }

  build() {
    Column({ space: 10 }) {

      //æœç´¢åŒºåŸŸ
      Row() {
        Image($r('app.media.ic_search'))
          .width(22)
          .fillColor('#817D83')
        TextInput({ placeholder: 'åªå› ä½ å¤ªç¾ŽðŸ”¥' })
          .placeholderColor('#817D83')
          .padding({ left: 5 })
          .fontColor('#999')
          .layoutWeight(1)
        Image($r('app.media.ic_code'))
          .width(20)
          .fillColor('#817D83')
      }
      .width('100%')
      .backgroundColor('#2D2B29')
      .border({ radius: 20 })
      .padding({ left: 8, right: 8 })

      Refresh({ refreshing: this.refreshing }) {
        Scroll(){
          Column() {
            //è½®æ’­å›¾
            Swiper() {
              ForEach(this.swiperList, (item: string) => {
                Image(item)
                  .width('100%')
                  .border({ radius: 10 })
              })
            }
            .height(170)
            .autoPlay(true)

            //æ¯æ—¥æŽ¨è
            this.titleBuilder("æ¯æ—¥æŽ¨è")
            List() {
              ForEach(this.dailyRecommend, (item: recommendDailyType, index: number) => {
                ListItem() {
                  Column() {
                    Text(item.type)
                      .width('100%')
                      .height(40)
                      .backgroundColor(item.top)
                      .padding({ left: 5 })
                      .fontSize(14)
                      .fontColor('#fff')
                    Image(item.img)
                      .width('100%')
                    Text(item.title)
                      .width('100%')
                      .backgroundColor(item.bottom)
                      .padding(5)
                      .fontSize(14)
                      .fontColor('#fff')
                      .maxLines(2)
                      .textOverflow({ overflow: TextOverflow.Ellipsis })
                  }
                  .width('40%')
                  .border({ radius: 10 })
                  .margin({ right: 10 })
                  .clip(true)
                }
              })
            }
            .height(230)
            .scrollBar(BarState.Off)
            .listDirection(Axis.Horizontal)

            //æŽ¨èæ­Œå•
            this.titleBuilder('æŽ¨èæ­Œå•')
            /* List() {
               ForEach(this.recommendList, (item: recommendListType, index: number) => {
                 ListItem() {
                   Column() {
                     Stack() {
                       Image(item.img)
                         .width('100%')
                         .height(100)
                         .border({ radius: 8 })
                       Text(item.count)
                         .fontColor('#fff')
                         .fontSize(12)
                         .fontWeight(700)
                         .margin({ left: 5, top: 5 })
                     }
                     .alignContent(Alignment.TopStart)

                     Text(item.title)
                       .fontColor('#fff')
                       .fontSize(14)
                       .width('100%')
                       .padding(5)
                       .maxLines(2)
                       .textOverflow({ overflow: TextOverflow.Ellipsis })
                   }
                   .width('30%').margin({ right: 10 })
                 }
               })
             }.scrollBar(BarState.Off).listDirection(Axis.Horizontal)*/
            List() {
              ForEach(this.chunk(this.recommendList, 3), (group: recommendListType[], rowIndex: number) => {
                ListItem() {
                  Row({ space: 10 }) {
                    ForEach(group, (item: recommendListType, index: number) => {
                      Column() {
                        Stack() {
                          Image(item.img)
                            .width('100%')
                            .height(100)
                            .border({ radius: 8 })

                          Text(item.count)
                            .fontColor('#fff')
                            .fontSize(12)
                            .fontWeight(700)
                            .margin({ left: 5, top: 5 })
                        }
                        .alignContent(Alignment.TopStart)

                        Text(item.title)
                          .fontColor('#fff')
                          .fontSize(14)
                          .width('100%')
                          .padding(5)
                          .maxLines(2)
                          .textOverflow({ overflow: TextOverflow.Ellipsis })
                      }
                      .width('30%') // æ¯è¡Œä¸‰ä¸ª
                    }, (item: recommendListType) => item.title) // ä½¿ç”¨å”¯ä¸€ key
                  }
                  .width('100%')
                  .justifyContent(FlexAlign.SpaceBetween)
                  .padding(10)
                }
              }, (rowIndex: number) => rowIndex.toString())
            }
            .scrollBar(BarState.Off)
          }
        }
        .scrollBar(BarState.Off)
      }
      .onRefreshing(() => {
        this.refreshing = true
        setTimeout(() => {
          this.refreshing = false
        }, 3000)
      })
    }
    .width('100%').height('100%')
    .padding({
      left: 10,
      right: 10,
      top: 5,
      bottom: 5
    })
  }

  chunk<T>(arr: T[], size: number): T[][] {
    const result: T[][] = []
    for (let i = 0; i < arr.length; i += size) {
      result.push(arr.slice(i, i + size))
    }
    return result
  }

}

